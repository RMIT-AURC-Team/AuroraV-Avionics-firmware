\doxysection{flash.\+c}
\hypertarget{flash_8c_source}{}\label{flash_8c_source}\index{Core/Src/SPI/flash/flash.c@{Core/Src/SPI/flash/flash.c}}

\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00001}00001\ \textcolor{preprocessor}{\#include\ "{}flash.h"{}}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00002}00002\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00003}00003\ \textcolor{comment}{/*\ SPI4\ FLASH}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00004}00004\ \textcolor{comment}{\ *\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00005}00005\ \textcolor{comment}{\ *\ Flash\ Pin\ \ \ \ \ \ \ |\ MCU\ GPIO\ Pin\ \ |\ SIGNAL\ TYPE}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00006}00006\ \textcolor{comment}{\ *\ -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/|-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00007}00007\ \textcolor{comment}{\ *\ SDI\ \ \ \ \ \ \ \ \ \ \ \ \ |\ PE14\ \ \ \ \ \ \ \ \ \ |\ DATA}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00008}00008\ \textcolor{comment}{\ *\ SDO\ \ \ \ \ \ \ \ \ \ \ \ \ |\ PE13\ \ \ \ \ \ \ \ \ \ |\ DATA}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00009}00009\ \textcolor{comment}{\ *\ SCLK\ \ \ \ \ \ \ \ \ \ \ \ |\ PE12\ \ \ \ \ \ \ \ \ \ |\ DATA}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00010}00010\ \textcolor{comment}{\ *\ CS\ \ \ \ \ \ \ \ \ \ \ \ \ \ |\ PE11\ \ \ \ \ \ \ \ \ \ |\ CONTROL}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00011}00011\ \textcolor{comment}{\ *\ Memory\ Hold\ \ \ \ \ |\ PE10\ \ \ \ \ \ \ \ \ \ |\ CONTROL}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00012}00012\ \textcolor{comment}{\ *\ Write\ Protect\ \ \ |\ PE9\ \ \ \ \ \ \ \ \ \ \ |\ CONTROL\ \ \ \ */}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00013}00013\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00014}00014\ \textcolor{comment}{/*\ ===============================================================================\ */}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00023}\mbox{\hyperlink{group___flash_gac40c1b5246c89d2d625430da01124049}{00023}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{group___flash_gac40c1b5246c89d2d625430da01124049}{Flash\_init}}(\mbox{\hyperlink{struct_flash}{Flash}}\ *flash,\ GPIO\_TypeDef\ *port,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}\ cs)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00024}00024\ \ \ \mbox{\hyperlink{group___s_p_i_ga656f7b06a728e76eb9ac0b10e1bd5bb7}{SPI\_init}}(\&flash-\/>\mbox{\hyperlink{struct_flash_a6e3a9ebc712a4a2f4d0d9e4ee0edf2f7}{base}},\ \mbox{\hyperlink{group___s_p_i_ggad258d4c51629346fceac4679b3209ad9aa44a4f1581ee02974dadb5d5d553b27b}{MEMORY\_FLASH}},\ SPI4,\ port,\ cs);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00025}00025\ \ \ flash-\/>\mbox{\hyperlink{struct_flash_ac2c453319e521f016b572ecf63a5fe74}{erase}}\ \ \ \ \ =\ \mbox{\hyperlink{group___flash_gaee89dc3026c93c50415e20cf3b10a303}{Flash\_erase}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00026}00026\ \ \ flash-\/>\mbox{\hyperlink{struct_flash_a31db821391750f58eb6a306c031698a2}{readPage}}\ \ =\ \mbox{\hyperlink{group___flash_gab5de712bbfe5d6c7bcd959337ff02f2b}{Flash\_readPage}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00027}00027\ \ \ flash-\/>\mbox{\hyperlink{struct_flash_ac94ed56d1714de0eddcf9e61557d7f77}{writePage}}\ =\ \mbox{\hyperlink{group___flash_gab522cee3393b2c9d6be5f85f13b1c12d}{Flash\_writePage}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00028}00028\ \}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00029}00029\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00030}00030\ \textcolor{comment}{/*********************************\ PRIVATE\ METHODS\ *********************************/}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00032}00032\ \textcolor{comment}{/*\ ===============================================================================\ */}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00041}00041\ \textcolor{keywordtype}{void}\ \_Flash\_writeEnable(\mbox{\hyperlink{struct_flash}{Flash}}\ *flash)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00042}00042\ \ \ \mbox{\hyperlink{struct_s_p_i}{SPI}}\ spi\ =\ flash-\/>\mbox{\hyperlink{struct_flash_a6e3a9ebc712a4a2f4d0d9e4ee0edf2f7}{base}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00043}00043\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00044}00044\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ \&=\ \string~spi.cs;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00045}00045\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ FLASH\_WRITE\_ENABLE);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00046}00046\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ |=\ spi.\mbox{\hyperlink{struct_s_p_i_a8f467bedd92cfa29ba7b757711ece04d}{cs}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00047}00047\ \}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00048}00048\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00049}00049\ \textcolor{comment}{/*\ ===============================================================================\ */}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00059}00059\ \textcolor{keywordtype}{void}\ \_Flash\_readStatus1(\mbox{\hyperlink{struct_flash}{Flash}}\ *flash,\ uint8\_t\ *status)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00060}00060\ \ \ \mbox{\hyperlink{struct_s_p_i}{SPI}}\ spi\ =\ flash-\/>\mbox{\hyperlink{struct_flash_a6e3a9ebc712a4a2f4d0d9e4ee0edf2f7}{base}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00062}00062\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ \&=\ \string~spi.cs;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00063}00063\ \ \ *status\ =\ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ FLASH\_READ\_STATUS\_REGISTER\_1);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00064}00064\ \ \ *status\ =\ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ 0x0F);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00065}00065\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ |=\ spi.\mbox{\hyperlink{struct_s_p_i_a8f467bedd92cfa29ba7b757711ece04d}{cs}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00066}00066\ \}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00067}00067\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00068}00068\ \textcolor{comment}{/*\ ===============================================================================\ */}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00078}00078\ \textcolor{keywordtype}{void}\ \_Flash\_readStatus2(\mbox{\hyperlink{struct_flash}{Flash}}\ *flash,\ uint8\_t\ *status)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00079}00079\ \ \ \mbox{\hyperlink{struct_s_p_i}{SPI}}\ spi\ =\ flash-\/>\mbox{\hyperlink{struct_flash_a6e3a9ebc712a4a2f4d0d9e4ee0edf2f7}{base}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00080}00080\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00081}00081\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ \&=\ \string~spi.cs;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00082}00082\ \ \ *status\ =\ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ FLASH\_READ\_STATUS\_REGISTER\_2);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00083}00083\ \ \ *status\ =\ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ 0x0F);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00084}00084\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ |=\ spi.\mbox{\hyperlink{struct_s_p_i_a8f467bedd92cfa29ba7b757711ece04d}{cs}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00085}00085\ \}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00087}00087\ \textcolor{comment}{/*\ ===============================================================================\ */}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00097}00097\ \textcolor{keywordtype}{void}\ \_Flash\_readStatus3(\mbox{\hyperlink{struct_flash}{Flash}}\ *flash,\ uint8\_t\ *status)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00098}00098\ \ \ \mbox{\hyperlink{struct_s_p_i}{SPI}}\ spi\ =\ flash-\/>\mbox{\hyperlink{struct_flash_a6e3a9ebc712a4a2f4d0d9e4ee0edf2f7}{base}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00099}00099\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00100}00100\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ \&=\ \string~spi.cs;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00101}00101\ \ \ *status\ =\ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ FLASH\_READ\_STATUS\_REGISTER\_3);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00102}00102\ \ \ *status\ =\ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ 0x0F);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00103}00103\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ |=\ spi.\mbox{\hyperlink{struct_s_p_i_a8f467bedd92cfa29ba7b757711ece04d}{cs}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00104}00104\ \}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00105}00105\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00106}00106\ \textcolor{comment}{/*********************************\ DEVICE\ METHODS\ **********************************/}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00107}00107\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00108}00108\ \textcolor{comment}{/*\ ===============================================================================\ */}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00115}\mbox{\hyperlink{group___flash_gaee89dc3026c93c50415e20cf3b10a303}{00115}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{group___flash_gaee89dc3026c93c50415e20cf3b10a303}{Flash\_erase}}(\mbox{\hyperlink{struct_flash}{Flash}}\ *flash)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00116}00116\ \ \ \_Flash\_writeEnable(flash);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00117}00117\ \ \ \mbox{\hyperlink{struct_s_p_i}{SPI}}\ spi\ \ \ \ \ \ \ \ =\ flash-\/>\mbox{\hyperlink{struct_flash_a6e3a9ebc712a4a2f4d0d9e4ee0edf2f7}{base}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00118}00118\ \ \ uint8\_t\ status\ =\ 0;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00119}00119\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00120}00120\ \ \ \textcolor{comment}{//\ Send\ Erase\ Chip\ instruction}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00121}00121\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ \&=\ \string~spi.cs;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00122}00122\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ FLASH\_ERASE\_CHIP);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00123}00123\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ |=\ spi.\mbox{\hyperlink{struct_s_p_i_a8f467bedd92cfa29ba7b757711ece04d}{cs}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00124}00124\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00125}00125\ \ \ \textcolor{comment}{//\ Wait\ until\ chip\ BUSY\ is\ clear}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00126}00126\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00127}00127\ \ \ \ \ \_Flash\_readStatus1(flash,\ \&status);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00128}00128\ \ \ \}\ \textcolor{keywordflow}{while}\ (status\ \&\ 0x01);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00129}00129\ \}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00130}00130\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00131}00131\ \textcolor{comment}{/*\ ===============================================================================\ */}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00140}\mbox{\hyperlink{group___flash_gab522cee3393b2c9d6be5f85f13b1c12d}{00140}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{group___flash_gab522cee3393b2c9d6be5f85f13b1c12d}{Flash\_writePage}}(\mbox{\hyperlink{struct_flash}{Flash}}\ *flash,\ uint32\_t\ address,\ uint8\_t\ *data)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00141}00141\ \ \ \_Flash\_writeEnable(flash);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00142}00142\ \ \ uint8\_t\ status\ =\ 0;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00143}00143\ \ \ \mbox{\hyperlink{struct_s_p_i}{SPI}}\ spi\ \ \ \ \ \ \ \ =\ flash-\/>\mbox{\hyperlink{struct_flash_a6e3a9ebc712a4a2f4d0d9e4ee0edf2f7}{base}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00144}00144\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00145}00145\ \ \ \textcolor{comment}{//\ Wait\ until\ chip\ BUSY\ is\ clear}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00146}00146\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00147}00147\ \ \ \ \ \_Flash\_readStatus1(flash,\ \&status);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00148}00148\ \ \ \}\ \textcolor{keywordflow}{while}\ (status\ \&\ 0x1);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00149}00149\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00150}00150\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ \&=\ \string~spi.cs;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00151}00151\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00152}00152\ \ \ \textcolor{comment}{//\ Send\ Page\ Program\ instruction\ and\ 24-\/bit\ address}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00153}00153\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ FLASH\_PAGE\_PROGRAM);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00154}00154\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ (address\ \&\ 0xFF0000)\ >>\ 16);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00155}00155\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ (address\ \&\ 0xFF00)\ >>\ 8);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00156}00156\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ (address\ \&\ 0xFF));}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00157}00157\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00158}00158\ \ \ \textcolor{comment}{//\ Send\ page\ data}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00159}00159\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ x\ =\ 0;\ x\ <\ 255;\ x++)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00160}00160\ \ \ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ data[x]);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00161}00161\ \ \ \}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00162}00162\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00163}00163\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ |=\ spi.\mbox{\hyperlink{struct_s_p_i_a8f467bedd92cfa29ba7b757711ece04d}{cs}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00164}00164\ \}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00165}00165\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00166}00166\ \textcolor{comment}{/*\ ===============================================================================\ */}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00175}\mbox{\hyperlink{group___flash_gab5de712bbfe5d6c7bcd959337ff02f2b}{00175}}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{group___flash_gab5de712bbfe5d6c7bcd959337ff02f2b}{Flash\_readPage}}(\mbox{\hyperlink{struct_flash}{Flash}}\ *flash,\ uint32\_t\ address,\ uint8\_t\ *data)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00176}00176\ \ \ uint8\_t\ status\ =\ 0;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00177}00177\ \ \ \mbox{\hyperlink{struct_s_p_i}{SPI}}\ spi\ \ \ \ \ \ \ \ =\ flash-\/>\mbox{\hyperlink{struct_flash_a6e3a9ebc712a4a2f4d0d9e4ee0edf2f7}{base}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00178}00178\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00179}00179\ \ \ \textcolor{comment}{//\ Wait\ until\ chip\ BUSY\ is\ clear}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00180}00180\ \ \ \textcolor{keywordflow}{do}\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00181}00181\ \ \ \ \ \_Flash\_readStatus1(flash,\ \&status);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00182}00182\ \ \ \}\ \textcolor{keywordflow}{while}\ (status\ \&\ 0x1);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00183}00183\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00184}00184\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ \&=\ \string~spi.cs;}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00185}00185\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00186}00186\ \ \ \textcolor{comment}{//\ Send\ Read\ Data\ instruction\ and\ 24-\/bit\ address}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00187}00187\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ FLASH\_READ\_DATA);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00188}00188\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ (address\ \&\ 0xFF0000)\ >>\ 16);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00189}00189\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ (address\ \&\ 0xFF00)\ >>\ 8);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00190}00190\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ (address\ \&\ 0xFF));}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00191}00191\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00192}00192\ \ \ \textcolor{comment}{//\ Receive\ page\ data}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00193}00193\ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 255;\ i++)\ \{}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00194}00194\ \ \ \ \ data[i]\ =\ spi.\mbox{\hyperlink{struct_s_p_i_a54668c3e267dcd01feff6c083a372846}{transmit}}(\&spi,\ 0x0F);}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00195}00195\ \ \ \}}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00196}00196\ }
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00197}00197\ \ \ spi.\mbox{\hyperlink{struct_s_p_i_a82241972e0292c7de95ea1e293e11be3}{port}}-\/>ODR\ |=\ spi.\mbox{\hyperlink{struct_s_p_i_a8f467bedd92cfa29ba7b757711ece04d}{cs}};}
\DoxyCodeLine{\Hypertarget{flash_8c_source_l00198}00198\ \}}

\end{DoxyCode}
